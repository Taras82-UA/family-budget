<!DOCTYPE html>
<html lang="uk">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>–°—ñ–º–µ–π–Ω–∏–π –±—é–¥–∂–µ—Ç</title>
  <script src="https://apis.google.com/js/api.js"></script>
  <style>
    body { font-family: sans-serif; padding: 1rem; }
    button { margin-top: 1rem; }
    textarea { width: 100%; height: 200px; margin-top: 1rem; }
  </style>
</head>
<body onload="handleClientLoad()">
  <h1>–°—ñ–º–µ–π–Ω–∏–π –±—é–¥–∂–µ—Ç</h1>
  <p>–ù–∞—Ç–∏—Å–Ω–∏ –∫–Ω–æ–ø–∫—É –Ω–∏–∂—á–µ, —â–æ–± –∑–±–µ—Ä–µ–≥—Ç–∏ –±—é–¥–∂–µ—Ç —É Google Drive:</p>

  <textarea id="budgetData" placeholder="–í–≤–µ–¥–∏ –∞–±–æ –≤—Å—Ç–∞–≤ –¥–∞–Ω—ñ –±—é–¥–∂–µ—Ç—É"></textarea>
  <br />
  <button onclick="saveToDrive()">üíæ –ó–±–µ—Ä–µ–≥—Ç–∏ –≤ Google Drive</button>

  <script>
    const CLIENT_ID = '–¢–í–û–ô_CLIENT_ID.apps.googleusercontent.com'; // <-- –∑–∞–º—ñ–Ω–∏ –Ω–∞ —Å–≤—ñ–π
    const SCOPES = 'https://www.googleapis.com/auth/drive.file';

    function handleClientLoad() {
      gapi.load('client:auth2', initClient);
    }

    function initClient() {
      gapi.client.init({
        clientId: CLIENT_ID,
        scope: SCOPES
      }).then(() => {
        gapi.auth2.getAuthInstance().signIn();
      });
    }

    function saveToDrive() {
      const data = document.getElementById('budgetData').value;
      const file = new Blob([data], { type: 'application/json' });
      const metadata = {
        name: 'family_budget.json',
        mimeType: 'application/json'
      };

      const accessToken = gapi.auth.getToken().access_token;
      const form = new FormData();
      form.append('metadata', new Blob([JSON.stringify(metadata)], { type: 'application/json' }));
      form.append('file', file);

      fetch('https://www.googleapis.com/upload/drive/v3/files?uploadType=multipart&fields=id', {
        method: 'POST',
        headers: new Headers({ 'Authorization': 'Bearer ' + accessToken }),
        body: form,
      })
      .then(res => res.json())
      .then(val => alert('‚úÖ –ó–±–µ—Ä–µ–∂–µ–Ω–æ –≤ Google Drive, ID: ' + val.id))
      .catch(err => console.error('‚ùå –ü–æ–º–∏–ª–∫–∞ –∑–±–µ—Ä–µ–∂–µ–Ω–Ω—è:', err));
    }
  </script>
</body>
</html>
